{"version":3,"file":"search.js","sources":["../src/search.js"],"sourcesContent":["import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport axios from 'axios';\n\nconst API_KEY = '46256747-1d18669c2152ad7d06c950e83';\nconst BASE_URL = 'https://pixabay.com/api/';\n\nconst form = document.querySelector('.search-form');\nconst gallery = document.querySelector('.gallery');\nconst loadMore = document.querySelector('.load-more');\n\nfunction createImageCard(image) {\n  return `\n    <div class=\"gallery-item\">\n      <a href=\"${image.largeImageURL}\">\n        <img class=\"gallery-img\" src=\"${image.webformatURL}\" alt=\"${image.tags}\" />\n      </a>\n      <div class=\"div-info\">\n        <div class=\"img-info\">\n        <span class=\"name\">Likes</span>\n        <span class=\"value\">${image.likes}</span>\n        </div>\n        <div class=\"img-info\">\n        <span class=\"name\">Views</span>\n        <span class=\"value\">${image.views}</span>\n        </div>\n        <div class=\"img-info\">\n        <span class=\"name\">Comments</span>\n        <span class=\"value\">${image.comments}</span>\n        </div>\n        <div class=\"img-info\">\n        <span class=\"name\">Downloads</span>\n        <span class=\"value\">${image.downloads}</span>\n        </div>\n      </div>\n    </div>\n  `;\n}\n\nfunction showLoader() {\n  document.querySelector('.loading-spinner').style.display = 'block';\n}\n\nfunction hideLoader() {\n  document.querySelector('.loading-spinner').style.display = 'none';\n}\n\nconst PER_PAGE = 40;\nlet currentPage = 1;\nlet currentQuery = '';\nlet totalHits = 0;\n\nfunction buildApiUrl(queryInput, page) {\n  const params = new URLSearchParams({\n    key: API_KEY,\n    q: queryInput,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: true,\n    per_page: PER_PAGE,\n    page: page,\n  });\n\n  return `${BASE_URL}?${params.toString()}`;\n}\n\nfunction createGallery(images) {\n  const imagesMarkup = images.map(image => createImageCard(image)).join('');\n  gallery.insertAdjacentHTML('beforeend', imagesMarkup);\n}\n\nfunction useLightbox() {\n  const lightbox = new SimpleLightbox('.gallery a', {\n    captionsData: 'alt',\n    captionDelay: 250,\n  });\n  lightbox.refresh();\n}\n\nfunction showLoadMore() {\n  loadMore.style.display = 'block';\n}\n\nfunction hideLoadMore() {\n  loadMore.style.display = 'none';\n}\n\nasync function fetchImages(queryInput, page) {\n  try {\n    showLoader();\n    const url = buildApiUrl(queryInput, page);\n    const response = await axios.get(url);\n    hideLoader();\n\n    const images = response.data.hits;\n    totalHits = response.data.totalHits;\n\n    if (images.length === 0) {\n      iziToast.error({\n        message:\n          'Sorry, there are no images matching your search query. Please try again!',\n      });\n      return;\n    }\n\n    createGallery(images);\n    useLightbox();\n\n    if (page * PER_PAGE < totalHits) {\n      showLoadMore();\n    } else {\n      hideLoadMore();\n      iziToast.info({\n        message: \"We're sorry, but you've reached the end of search results.\",\n      });\n    }\n    hideLoadingSpinnerMore();\n  } catch (error) {\n    console.log(error);\n    hideLoader();\n    hideLoadingSpinnerMore();\n  }\n}\n\nform.addEventListener('submit', event => {\n  event.preventDefault();\n\n  const queryInput = form.querySelector('.search-input').value.trim();\n\n  currentQuery = queryInput;\n  currentPage = 1;\n  gallery.innerHTML = '';\n  hideLoadMore();\n\n  showLoader();\n\n  fetchImages(currentQuery, currentPage);\n});\n\nconst loadingSpinnerMore = document.querySelector('.loading-spinner-more');\n\nfunction showLoadingSpinnerMore() {\n  loadingSpinnerMore.style.display = 'block';\n}\n\nfunction hideLoadingSpinnerMore() {\n  loadingSpinnerMore.style.display = 'none';\n}\n// loadMore.addEventListener('click', () => {\n//   hideLoadMore();\n//   currentPage += 1;\n//   showLoadingSpinnerMore();\n//   fetchImages(currentQuery, currentPage).then(() => {\n//     smoothScroll();\n//   });\n// });\n\nloadMore.addEventListener('click', async () => {\n  hideLoadMore();\n  currentPage += 1;\n  showLoadingSpinnerMore();\n\n  try {\n    await fetchImages(currentQuery, currentPage);\n    smoothScroll();\n  } catch (error) {\n    console.log(error);\n  }\n});\n\nfunction smoothScroll() {\n  const galleryItem = document.querySelector('.gallery-item');\n  if (galleryItem) {\n    const itemHeight = galleryItem.getBoundingClientRect().height;\n    window.scrollBy({\n      top: itemHeight * 2,\n      behavior: 'smooth',\n    });\n  }\n}\n"],"names":["API_KEY","BASE_URL","form","gallery","loadMore","createImageCard","image","showLoader","hideLoader","PER_PAGE","currentPage","currentQuery","totalHits","buildApiUrl","queryInput","page","params","createGallery","images","imagesMarkup","useLightbox","SimpleLightbox","showLoadMore","hideLoadMore","fetchImages","url","response","axios","iziToast","hideLoadingSpinnerMore","error","event","loadingSpinnerMore","showLoadingSpinnerMore","smoothScroll","galleryItem","itemHeight"],"mappings":"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"}